<!--
    Document   : Ninja.agent.xml.xml
    Created on : October 2, 2010, 7:19 PM
    Author     : unicorn
    Description:
        Purpose of the document follows.
-->

<agent xmlns="http://jadex.sourceforge.net/jadex"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://jadex.sourceforge.net/jadex
http://jadex.sourceforge.net/jadex-0.96.xsd"
name="Ninja"
package="com.rssninja.ninja">
    <capabilities>
        <capability name="amscap" file="jadex.planlib.AMS" />
    </capabilities>
    <goals>
        <achievegoalref name = "ams_create_agent">
            <concrete ref="amscap.ams_create_agent" />
        </achievegoalref>
        <achievegoal name ="send_links">
            <unique />
            <createcondition>
                $beliefbase.info_updated
            </createcondition>
            <deliberation>
                <inhibits ref="mantain_performance" />
            </deliberation>
        </achievegoal>
        <mantaingoal name="matain_performance">
            <mantaincondition>
                $beliefbase.performance &gt;= 0.2
            </mantaincondition>
            <targetcondition>
                $beliefbase.performance &gt;= 0.4
            </targetcondition>
        </mantaingoal>
        <achievegoal name ="update_semantics">
            <unique />
            <deliberation>
                <inhibits ref="send_links" />
                <inhibits ref="mantain_peformance" />
            </deliberation>
        </achievegoal>
        <achievegoal name ="search_info" retry="">
            <unique />
            <createcondition>
                $beliefbase.time_since_last_update &gt;= $beliefbase.update_interval;
            </createcondition>
            <deliberation>
                <inhibits ref="mantain_performance" />
                <inhibits ref="send_links" />
            </deliberation>
        </achievegoal>
    </goals>
    <plans>
        <plan name = "send_info">
            <body> new SendInfoToSensei() </body> <!--TODO -->
            <trigger>
               <goal ref="send_links" />
            </trigger>
        </plan>
        <plan name ="analyze_info">
            <body>new ClassifyInfoPlan()</body> <!--TODO-->
            <trigger>
                <messageevent ref="inform" />
                <goal ref="update_semantics" />
            </trigger>
        </plan>
        <plan name ="search_database">
            <body> new SearchDatabase()</body> <!--TODO-->
            <trigger>
                <goal ref="search_info" />
            </trigger>
        </plan>
        <plan name = "getinfo">
            <body>new Ninja()</body>
            <trigger>
                <messageevent ref="pull"/>
                <goal ref="search_info" />
            </trigger>
        </plan>
    </plans>
    <events>
        <messageevent name="pull" direction="receive" type="fipa">
            <parameter name="performative" class="String" direction="fixed">
                <value>jadex.adapter.fipa.SFipa.REQUEST</value>
            </parameter>
        </messageevent>
        <messageevent name ="inform" direction = "receive" type="fipa">
            <parameter name="performative" class="String" direction = "fixed">
                <value>jadex.adapter.fipa.SFipa.INFORM</value>
            </parameter>
        </messageevent>
        <messageevent name="search" direction="send" type="fipa">
            <parameter name="performative" class="String" direction="fixed">
                <value>jadex.adapter.fipa.SFipa.REQUEST</value>
            </parameter>
        </messageevent>
    </events>
    <beliefs>
        <belief name="tag" class="String">
            <fact>""</fact>
        </belief>            
        <beliefset name="related_links" class="String">
            <facts evaluationmode="dynamic">
                Database.getRelatedLinks(getBeliefbase().getBelief("tag"))
            </facts>
        </beliefset>
        <belief name="sensei" class="AgentIdentifier">
            <fact>""</fact>
        </belief>
        <belief name="performance" class="Float">
            <fact>3.0</fact>
        </belief>
        <belief name="last_update" class="long">
            <fact> 0 </fact>
        </belief>
        <belief name="info_updated" class="boolean">
            <fact> false </fact>
        </belief>
        <belief name="update_interval" class="long">
            <fact>5*60*1000</fact><!-- quitar numeros magicos -->
        </belief>
    </beliefs>
</agent>